---
title: "figures_and_tables"
output: html_document
date: "2024-04-03"
editor_options: 
  chunk_output_type: console
  markdown: 
    wrap: 72
---

# Library

```{r}
library(tidyverse)
library(googlesheets4)
library(oce)
library(padr)
library(rEDM)
library(ggplot2)
library(zoo)
library(quantreg)
library(dplyr)

```


# PRELIM STATS 

#FIND CRITICAL VALUES

```{r}
critical.r <- function( n, alpha = .05 ) {
  df <- n - 2
  critical.t <- qt(alpha/2, df, lower.tail = F)
  critical.r <- sqrt( (critical.t^2) / ( (critical.t^2) + df ) )
  return(critical.r)
}
# Example usage: Critical correlation coefficient at sample size of n = 100
critical.r( 100 )


if (file.exists("critical.r .rds")) {
  # If it's saved locally, load the data
  critical.r <- readRDS("critical.r.rds")
} else {
  # If it's not saved locally, read it from Google Sheets and save it locally
  saveRDS(critical.r , "critical.r .rds")
}

```


#TABLE AG_DF_CR

```{r}
# Assuming 'ag_df_CR' is your data frame

# Create an empty list to store the results
lm_list <- list()

# List of variables to include in the linear models
vars <- c("ph", "Celsius", "spcond", "do", "turb", "Salinity")

# Iterate over each variable
for (var in vars) {
  # Create the formula for the linear model
  formula_chl <- paste("chl ~", var)
  formula_phy <- paste("phy ~", var)
  
  # Fit the linear model for 'chl'
  lm_chl <- lm(formula_chl, data = ag_df_CR)
  # Fit the linear model for 'phy'
  lm_phy <- lm(formula_phy, data = ag_df_CR)
  
  # Store the results in the list
  lm_list[[paste(var, "chl", sep = "_")]] <- lm_chl
  lm_list[[paste(var, "phy", sep = "_")]] <- lm_phy
}

```

```{r}
# Create an empty data frame to store the results
results_df <- data.frame(variable = character(), response = character(), 
                          correlation = numeric(), r_squared = numeric(), p_value = numeric(),
                          stringsAsFactors = FALSE)

# Iterate over each variable
for (var in vars) {
  # Create the formula for the linear model
  formula_chl <- paste("chl ~", var)
  formula_phy <- paste("phy ~", var)
  
  # Fit the linear model for 'chl'
  lm_chl <- lm(formula_chl, data = ag_df_CR)
  # Fit the linear model for 'phy'
  lm_phy <- lm(formula_phy, data = ag_df_CR)
  
  # Extract the correlation coefficient, R-squared value, and p-value
  cor_chl <- cor(ag_df_CR[[var]], ag_df_CR$chl)
  cor_phy <- cor(ag_df_CR[[var]], ag_df_CR$phy)
  r_squared_chl <- summary(lm_chl)$r.squared
  r_squared_phy <- summary(lm_phy)$r.squared
  p_value_chl <- summary(lm_chl)$coefficients[2, 4]
  p_value_phy <- summary(lm_phy)$coefficients[2, 4]
  
  # Add the results to the data frame
  results_df <- rbind(results_df, 
                      data.frame(variable = var, response = "chl",
                                 correlation = cor_chl, r_squared = r_squared_chl, p_value = p_value_chl),
                      data.frame(variable = var, response = "phy",
                                 correlation = cor_phy, r_squared = r_squared_phy, p_value = p_value_phy))
}

# Print the results
print(results_df)

```

#TABLE All.Logan

#TABLE All.CR_nutrients

#TABLE All.bacteria



#PLOT 2021 DRIVERS

####Visualize Salinity

```{r}
#Visualize Salinity 2021 

df_CR <- df_CR %>% pad()

df_CR %>%
  mutate(date = as.Date(date)) %>%
  group_by(date) %>%
  filter(date >= as.Date("2021-05-01") & date <= as.Date("2021-11-01"))  %>%
  ggplot(aes(x = date)) + 
  geom_path(aes(y = Salinity, color = "Salinity")) +
  scale_x_date(date_labels = "%b", date_breaks = "1 month") +
  ggtitle("Salinity 2021") +
  theme(plot.title = element_text(hjust = 0.5)) +
  labs(x = "Month", y = "Salinity (ppm)")

#Visualize Chl 2021 

df_CR %>%
  mutate(date = as.Date(date)) %>%
  group_by(date) %>%
  filter(date >= as.Date("2021-05-01") & date <= as.Date("2021-11-01"))  %>%
  ggplot(aes(x = date)) + 
  geom_path(aes(y = chl, color = "chl")) +
  scale_x_date(date_labels = "%b", date_breaks = "1 month") +
  ggtitle("Chlorophyll 2021") +
  theme(plot.title = element_text(hjust = 0.5)) +
  labs(x = "Month", y = "Chlorophyll (RFU)")
  

#Visualize Phy 2021 

df_CR %>%
  mutate(date = as.Date(date)) %>%
  group_by(date) %>%
  filter(date >= as.Date("2021-05-01") & date <= as.Date("2021-11-01"))  %>%
  ggplot(aes(x = date)) + 
  geom_path(aes(y = chl, color = "phy")) +
  scale_x_date(date_labels = "%b", date_breaks = "1 month") +
  ggtitle("Phycocanin 2021") +
  theme(plot.title = element_text(hjust = 0.5)) +
  labs(x = "Month", y = "Phycocanin (RFU)")


df_CR %>% group_by(date,hour) %>%
    mutate(date = as.Date(date)) %>%
  group_by(date) %>%
  filter(date >= as.Date("2021-05-01") & date <= as.Date("2021-11-01"))  %>%
  ggplot(aes(x=date)) + 
  geom_path(aes(y=chl,color="chl")) + 
  geom_path(aes(y=phy,color="phy")) +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggtitle(" < 2021 Chlorophyll V. Phycocanin ") + 
    labs(x = "Dates", y = "RFU")



ag_df_CR %>% 
  group_by(date) %>%
  filter(date >= as.Date("2021-05-01") & date <= as.Date("2021-11-01"))  %>%
  ggplot(aes(x=date)) + 
  geom_path(aes(y=chl,color="Chlorophyll (RFU)")) + 
  geom_path(aes(y=phy,color="Phycocanin (RFU)")) +
    scale_color_manual(values=c("Chlorophyll (RFU)"="darkgreen", "Phycocanin (RFU)"="orange")) +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggtitle("2021 Chlorophyll V. Phycocanin ") + 
    labs(x = "Dates", y = "RFU (Relative Fluorescence Units)")


  ag_df_CR <- ag_df_CR %>% pad()


ag_df_CR %>% 
  group_by(date) %>%
  filter(date >= as.Date("2015-05-01") & date <= as.Date("2021-11-01"))  %>%
  ggplot(aes(x=date)) + 
  geom_path(aes(y=chl,color="Chlorophyll (RFU)")) + 
  geom_path(aes(y=phy,color="Phycocanin (RFU)")) +
    scale_color_manual(values=c("Chlorophyll (RFU)"="darkgreen", "Phycocanin (RFU)"="orange")) +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggtitle("< 2021 Chlorophyll V. Phycocanin ") + 
    labs(x = "Dates", y = "RFU (Relative Fluorescence Units)")

ag_df_CR <- na.omit(ag_df_CR)


```

### Plot All EPA Buoy Vars All Time

```{r}
#df_CR
df_CR %>%
  group_by(date, hour) %>%
  summarise(across(c("chl", "phy", "ph", "Celsius", "spcond", "do", "turb", "Salinity"), mean), .groups = "keep") %>%
  mutate(date = date + hours(hour)) %>%
  ggplot(aes(x = date)) +
  geom_path(aes(y = chl, color = "Chlorophyll (RFU)")) +
  geom_path(aes(y = phy, color = "Phycocanin (RFU)")) +
  geom_path(aes(y = ph, color = "pH")) +
  geom_path(aes(y = Celsius, color = "Temperature (Celsius)")) +
  geom_path(aes(y = spcond, color = "Specific Conductance Ratio (mS/cm)")) +
  geom_path(aes(y = do, color = "Dissolved Oxygen (mg/L)")) +
  geom_path(aes(y = turb, color = "Turbidity (FNU)")) +
  geom_path(aes(y = Salinity, color = "Salinity (ppm)")) +
  scale_color_manual(
    values = c("Chlorophyll (RFU)" = "green",
               "Phycocanin (RFU)" = "orange",
               "pH" = "brown",
               "Temperature (Celsius)" = "red",
               "Specific Conductance Ratio (mS/cm)" = "pink",
               "Dissolved Oxygen (mg/L)" = "yellow",
               "Turbidity (FNU)" = "purple",
               "Salinity (ppm)" = "blue"),
    name = "Color"
  ) + 
      labs(x = "Dates", y = "Units") +
theme(plot.title = element_text(hjust = 0.5)) +
  ggtitle("All EPA Buoy Vars")


ag_df_CR <- ag_df_CR %>%
    mutate(date = as.POSIXct(date, format = "%Y-%m-%d"))
  ag_df_CR <- ag_df_CR %>% pad()
  
#ag_df_CR
ag_df_CR %>%
    mutate(date = as.POSIXct(date, format = "%Y-%m-%d")) %>%
  group_by(date) %>%
  summarise(across(c("chl", "phy", "ph", "Celsius", "spcond", "do", "turb", "Salinity"), mean), .groups = "keep") %>%
  ggplot(aes(x = date)) +
  geom_path(aes(y = chl, color = "Chlorophyll (RFU)")) +
  geom_path(aes(y = phy, color = "Phycocanin (RFU)")) +
  geom_path(aes(y = ph, color = "pH")) +
  geom_path(aes(y = Celsius, color = "Temperature (Celsius)")) +
  geom_path(aes(y = spcond, color = "Specific Conductance Ratio (mS/cm)")) +
  geom_path(aes(y = do, color = "Dissolved Oxygen (mg/L)")) +
  geom_path(aes(y = turb, color = "Turbidity (FNU)")) +
  geom_path(aes(y = Salinity, color = "Salinity (ppm)")) +
  scale_color_manual(
    values = c("Chlorophyll (RFU)" = "green",
               "Phycocanin (RFU)" = "orange",
               "pH" = "brown",
               "Temperature (Celsius)" = "red",
               "Specific Conductance Ratio (mS/cm)" = "pink",
               "Dissolved Oxygen (mg/L)" = "yellow",
               "Turbidity (FNU)" = "purple",
               "Salinity (ppm)" = "blue"),
    name = "Color"
  ) + 
      labs(x = "Dates", y = "Units") +
theme(plot.title = element_text(hjust = 0.5)) +
    ylim(0, 31) +
  ggtitle("2015 - 2023 EPA Buoy Variables")


ag_df_CR <- na.omit(ag_df_CR)


```

####CR BUOY

```{r}
ag_df_CR

ag_df_CR$chl

ag_df_CR$phy

ag_df_CR$ph

ag_df_CR$Celsius

ag_df_CR$spcond

ag_df_CR$do

ag_df_CR$turb

ag_df_CR$Salinity

```

###9:12

```{r}

morndf_CR

morndf_CR$chl

mornddf_CR$phy

mornddf_CR$ph

mornddf_CR$Celsius

mornddf_CR$spcond

mornddf_CR$do

mornddf_CR$turb

mornddf_CR$Salinity


```

#ACFs

```{r}

ag_df_CR
morndf_CR
df_CR



```

###ACF Aggreggated

```{r}
ag_df_CR <- na.omit(ag_df_CR)

#2021
ts_chl_2021 <- ag_df_CR %>% 
  filter(year(date) == 2021) %>%
  group_by(date) %>%
  summarise(across(c("chl","phy"),mean),.groups = "keep") %>%
  pull(chl)

ts_phy_2021 <- ag_df_CR %>% 
  filter(year(date) == 2021) %>%
  group_by(date) %>%
  summarise(across(c("chl","phy"),mean),.groups = "keep") %>%
  pull(phy)


#MORNDF
morndf_chl_2021 <- ag_df_CR %>% 
  filter(year(date) == 2021) %>%
  group_by(date) %>%
  summarise(across(c("chl","phy"),mean),.groups = "keep") %>%
  pull(chl)

morndf_phy_2021 <- ag_df_CR %>% 
  filter(year(date) == 2021) %>%
  group_by(date) %>%
  summarise(across(c("chl","phy"),mean),.groups = "keep") %>%
  pull(phy)

length(ts_chl_2021)
acf(ts_chl_2021,lag.max = 24*30, main = " Hourly Chlorophyll ACF")
abline(h = c(0.3,0.6) , col = c("red","red")) #change to lagmax = 30 if want days 
#determine lag -talk to deyle?
acf(ts_phy_2021,lag.max = 24*30, main = "Hourly Phycocanin ACF")
abline(h = c(0.3,0.6) , col = c("red","red"))

acf(ts_chl_2021,lag.max = 30, main = "Daily Chlorophyll ACF")
abline(h = c(0.3,0.6) , col = c("red","red")) #change to lagmax = 30 if want days 
#determine lag -talk to deyle?
acf(ts_phy_2021,lag.max = 30, main = "Daily Phycocanin  ACF")
abline(h = c(0.3,0.6) , col = c("red","red"))

length(ts_chl_2021)
acf(ts_chl_2021,lag.max = 24*30, main = " 9 AM - 12 PM Chlorophyll ACF")
abline(h = c(0.3,0.6) , col = c("red","red")) #change to lagmax = 30 if want days 
#determine lag -talk to deyle?
acf(ts_phy_2021,lag.max = 24*30, main = "9 AM - 12 PM Phycocanin ACF")
abline(h = c(0.3,0.6) , col = c("red","red"))

## you can check an individual value as follows
cor(ts_phy_2021,lag(ts_phy_2021,6),use="pairwise")

df_CR <- na.omit(df_CR)
#2021
ts_chl_2021 <- df_CR %>% 
  filter(year(date) == 2021) %>%
  group_by(date) %>%
  summarise(across(c("chl","phy"),mean),.groups = "keep") %>%
  pull(chl)

ts_phy_2021 <- df_CR %>% 
  filter(year(date) == 2021) %>%
  group_by(date) %>%
  summarise(across(c("chl","phy"),mean),.groups = "keep") %>%
  pull(phy)

length(ts_chl_2021)
acf(ts_chl_2021,lag.max = 24*30, main = " Hourly Chlorophyll ACF")
abline(h = c(0.3,0.6) , col = c("red","red")) #change to lagmax = 30 if want days 
#determine lag -talk to deyle?
acf(ts_phy_2021,lag.max = 24*30, main = "Hourly Phycocanin ACF")
abline(h = c(0.3,0.6) , col = c("red","red"))




```

#PACFs

```{r}

morndf_CR <- na.omit(morndf_CR)
ag_df_CR<- na.omit(ag_df_CR)

#2021
ts_chl_2021 <- ag_df_CR %>% 
  filter(year(date) == 2021) %>%
  group_by(date) %>%
  summarise(across(c("chl","phy"),mean),.groups = "keep") %>%
  pull(chl)

ts_phy_2021 <- ag_df_CR %>% 
  filter(year(date) == 2021) %>%
  group_by(date) %>%
  summarise(across(c("chl","phy"),mean),.groups = "keep") %>%
  pull(phy)


#MORNDF
morndf_chl_2021 <- ag_df_CR %>% 
  filter(year(date) == 2021) %>%
  group_by(date) %>%
  summarise(across(c("chl","phy"),mean),.groups = "keep") %>%
  pull(chl)

morndf_phy_2021 <- ag_df_CR %>% 
  filter(year(date) == 2021) %>%
  group_by(date) %>%
  summarise(across(c("chl","phy"),mean),.groups = "keep") %>%
  pull(phy)


acf(ts_chl_2021,lag.max = 20, main = "Daily Chlorophyll ACF")
abline(h = c(0.3,0.6) , col = c("red","red")) #change to lagmax = 30 if want days 
#determine lag -talk to deyle?
acf(ts_phy_2021,lag.max = 20, main = "Daily Phycocanin  ACF")
abline(h = c(0.3,0.6) , col = c("red","red"))

length(ts_chl_2021)
acf(ts_chl_2021,lag.max = 20, main = " 9 AM - 12 PM Chlorophyll ACF")
abline(h = c(0.3,0.6) , col = c("red","red")) #change to lagmax = 30 if want days 
#determine lag -talk to deyle?
acf(ts_phy_2021,lag.max = 20, main = "9 AM - 12 PM Phycocanin ACF")
abline(h = c(0.3,0.6) , col = c("red","red"))

## you can check an individual value as follows
cor(ts_phy_2021,lag(ts_phy_2021,6),use="pairwise")


#PACF 2021
pacf2021 <- morndf_CR %>% 
  filter(year(date)==2021) %>%
  pull(chl) %>%
  pacf(lag.max = 7 )
plot(pacf2021, main = " 9 AM - 12 PM Chlorophyll PACF")

pacf2021 <- morndf_CR %>% 
  filter(year(date)==2021) %>%
  pull(phy) %>%
  pacf(lag.max= 7)
plot(pacf2021, main = "9 AM - 12 PM Phycocanin PACF")


pacf2021 <- ag_df_CR %>% 
  filter(year(date)==2021) %>%
  pull(chl) %>%
  pacf(lag.max= 7)
plot(pacf2021, main = "Daily Chlorophyll PACF")

pacf2021 <- ag_df_CR %>% 
  filter(year(date)==2021) %>%
  pull(phy) %>%
  pacf(lag.max= 7)
plot(pacf2021, main = "Daily Phyocanin PACF")




```

###HOURLY

```{r}

df_CR


#CHL
acf_chl_2021 <- df_CR %>% 
  filter(year(date) == 2021) %>%
  group_by(date,hour) %>%
  summarise(across(c("chl", "phy", "ph", "Celsius", "spcond", "do", "turb", "Salinity",),mean),.groups = "keep") %>%
  pull(chl)

#PHY
acf_phy_2021 <- df_CR %>% 
  filter(year(date) == 2021) %>%
  group_by(date,hour) %>%
  summarise(across(c("chl", "phy", "ph", "Celsius", "spcond", "do", "turb", "Salinity",),mean),.groups = "keep") %>%
  pull(phy)

#ph
acf_ph_2021 <- df_CR %>% 
  filter(year(date) == 2021) %>%
  group_by(date,hour) %>%
  summarise(across(c("chl", "phy", "ph", "Celsius", "spcond", "do", "turb", "Salinity",),mean),.groups = "keep") %>%
  pull(ph)

#Celsius
acf_Celsius_2021 <- df_CR %>% 
  filter(year(date) == 2021) %>%
  group_by(date,hour) %>%
  summarise(across(c("chl", "phy", "ph", "Celsius", "spcond", "do", "turb", "Salinity",),mean),.groups = "keep") %>%
  pull(Celsius)

#spcond
acf_spcond_2021 <- df_CR %>% 
  filter(year(date) == 2021) %>%
  group_by(date,hour) %>%
  summarise(across(c("chl", "phy", "ph", "Celsius", "spcond", "do", "turb", "Salinity",),mean),.groups = "keep") %>%
  pull(spcond)

#spcond
acf_do_2021 <- df_CR %>% 
  filter(year(date) == 2021) %>%
  group_by(date,hour) %>%
  summarise(across(c("chl", "phy", "ph", "Celsius", "spcond", "do", "turb", "Salinity",),mean),.groups = "keep") %>%
  pull(do)

#turb
acf_turb_2021 <- df_CR %>% 
  filter(year(date) == 2021) %>%
  group_by(date,hour) %>%
  summarise(across(c("chl", "phy", "ph", "Celsius", "spcond", "do", "turb", "Salinity",),mean),.groups = "keep") %>%
  pull(turb)

#Salinity 
acf_Salinity_2021 <- df_CR %>% 
  filter(year(date) == 2021) %>%
  group_by(date,hour) %>%
  summarise(across(c("chl", "phy", "ph", "Celsius", "spcond", "do", "turb", "Salinity",),mean),.groups = "keep") %>%
  pull(Salinity)


#DO LEGENDS


length(ts_chl_2021)
acf(ts_chl_2021,lag.max = 24*30, main = "Cholorophyll Hourly Non-Aggregated ACF")
abline(h = c(0.3,0.6) , col = c("red","red")) #change to lagmax = 30 if want days 

#determine lag -talk to deyle?
acf(ts_phy_2021,lag.max = 24*30, main = "Phycocanin Hourly Non-Aggregated ACF")
abline(h = c(0.3,0.6) , col = c("red","red"))

acf(ts_chl_2021,lag.max = 30, main = "Cholorophyll Daily Non-Aggregated ACF")
abline(h = c(0.3,0.6) , col = c("red","red")) #change to lagmax = 30 if want days 
#determine lag -talk to deyle?
acf(ts_phy_2021,lag.max = 30, main = "Phycocanin Daily Non-Aggregated ACF")
abline(h = c(0.3,0.6) , col = c("red","red"))


## you can check an individual value as follows
cor(ts_phy_2021,lag(ts_phy_2021,6),use="pairwise")



#df_CR$chl

#df_CR$phy

#df_CR$ph

#df_CR$Celsius

#df_CR$spcond

#df_CR$do

#df_CR$turb

#df_CR$Salinity


```

##LOGAN

```{r}


#ag_Logan$HourlyAltimeterSetting 


acf_ag_Logan$HourlyAltimeterSetting <- ag_Logan %>% 
  filter(year(date) == 2021) %>%
  group_by(date,hour) %>%
  summarise(across(c("    ag_Logan$HourlyAltimeterSetting ",
"HourlyDewPointTemperature ", "HourlyDryBulbTemperature ", "HourlyPrecipitation", "HourlyRelativeHumidity", "HourlyStationPressure ", "HourlyVisibility", "HourlyWetBulbTemperature ", "HourlyWindDirection ", "HourlyWindGustSpeed", "HourlyWindSpeed") %>%
  pull(HourlyAltimeterSetting)


     #acf_ag_Logan$HourlyDewPointTemperature 
     
     acf_ag_Logan$HourlyDewPointTemperature <- ag_Logan %>% 
  filter(year(date) == 2021) %>%
  group_by(date,hour) %>%
  summarise(across(c("HourlyDewPointTemperature ", "HourlyDryBulbTemperature ", "HourlyPrecipitation", "HourlyRelativeHumidity", "HourlyStationPressure ", "HourlyVisibility", "HourlyWetBulbTemperature ", "HourlyWindDirection ", "HourlyWindGustSpeed", "HourlyWindSpeed") %>%
  pull(HourlyDewPointTemperature)
    
     #acf_ag_Logan$HourlyDryBulbTemperature 
     
      acf_ag_Logan$HourlyDryBulbTemperature  <- ag_Logan %>% 
  filter(year(date) == 2021) %>%
  group_by(date,hour) %>%
  summarise(across(c("HourlyDewPointTemperature ", "HourlyDryBulbTemperature ", "HourlyPrecipitation", "HourlyRelativeHumidity", "HourlyStationPressure ", "HourlyVisibility", "HourlyWetBulbTemperature ", "HourlyWindDirection ", "HourlyWindGustSpeed", "HourlyWindSpeed") %>%
  pull(HourlyDryBulbTemperature )
    
     #acf_ag_Logan$HourlyPrecipitation 
  
   acf_ag_Logan$HourlyPrecipitation  <- ag_Logan %>% 
  filter(year(date) == 2021) %>%
  group_by(date,hour) %>%
  summarise(across(c("HourlyDewPointTemperature ", "HourlyDryBulbTemperature ", "HourlyPrecipitation", "HourlyRelativeHumidity", "HourlyStationPressure ", "HourlyVisibility", "HourlyWetBulbTemperature ", "HourlyWindDirection ", "HourlyWindGustSpeed", "HourlyWindSpeed") %>%
  pull(HourlyPrecipitation)
    
    #acf_ag_Logan$HourlyRelativeHumidity 
  
   acf_ag_Logan$HourlyRelativeHumidity <- ag_Logan %>% 
  filter(year(date) == 2021) %>%
  group_by(date,hour) %>%
  summarise(across(c("HourlyDewPointTemperature ", "HourlyDryBulbTemperature ", "HourlyPrecipitation", "HourlyRelativeHumidity", "HourlyStationPressure ", "HourlyVisibility", "HourlyWetBulbTemperature ", "HourlyWindDirection ", "HourlyWindGustSpeed", "HourlyWindSpeed") %>%
  pull(HourlyRelativeHumidity )
   
     #acf_ag_Logan$HourlyStationPressure 
  
   acf_ag_Logan$HourlyStationPressure  <- ag_Logan %>% 
  filter(year(date) == 2021) %>%
  group_by(date,hour) %>%
  summarise(across(c("HourlyDewPointTemperature ", "HourlyDryBulbTemperature ", "HourlyPrecipitation", "HourlyRelativeHumidity", "HourlyStationPressure ", "HourlyVisibility", "HourlyWetBulbTemperature ", "HourlyWindDirection ", "HourlyWindGustSpeed", "HourlyWindSpeed") %>%
  pull(HourlyStationPressure)
    
     #acf_ag_Logan$HourlyVisibility
  
   acf_ag_Logan$HourlyVisibility <- ag_Logan %>% 
  filter(year(date) == 2021) %>%
  group_by(date,hour) %>%
  summarise(across(c("HourlyDewPointTemperature ", "HourlyDryBulbTemperature ", "HourlyPrecipitation", "HourlyRelativeHumidity", "HourlyStationPressure ", "HourlyVisibility", "HourlyWetBulbTemperature ", "HourlyWindDirection ", "HourlyWindGustSpeed", "HourlyWindSpeed") %>%
  pull(HourlyVisibility)
    
    #acf_ag_Logan$HourlyWetBulbTemperature 
  
   acf_ag_LoganHourlyWetBulbTemperature <- ag_Logan %>% 
  filter(year(date) == 2021) %>%
  group_by(date,hour) %>%
  summarise(across(c("HourlyDewPointTemperature ", "HourlyDryBulbTemperature ", "HourlyPrecipitation", "HourlyRelativeHumidity", "HourlyStationPressure ", "HourlyVisibility", "HourlyWetBulbTemperature ", "HourlyWindDirection ", "HourlyWindGustSpeed", "HourlyWindSpeed") %>%
  pull(HourlyWetBulbTemperature )
    
     #acf_ag_Logan$HourlyWindDirection 
  
   acf_ag_Logan$HourlyWindDirection  <- ag_Logan %>% 
  filter(year(date) == 2021) %>%
  group_by(date,hour) %>%
  summarise(across(c("HourlyDewPointTemperature ", "HourlyDryBulbTemperature ", "HourlyPrecipitation", "HourlyRelativeHumidity", "HourlyStationPressure ", "HourlyVisibility", "HourlyWetBulbTemperature ", "HourlyWindDirection ", "HourlyWindGustSpeed", "HourlyWindSpeed") %>%
  pull(HourlyWindDirection )
    
     #acf_ag_Logan$HourlyWindGustSpeed
  
   acf_ag_Logan$HourlyWindGustSpeed <- ag_Logan %>% 
  filter(year(date) == 2021) %>%
  group_by(date,hour) %>%
  summarise(across(c("HourlyDewPointTemperature ", "HourlyDryBulbTemperature ", "HourlyPrecipitation", "HourlyRelativeHumidity", "HourlyStationPressure ", "HourlyVisibility", "HourlyWetBulbTemperature ", "HourlyWindDirection ", "HourlyWindGustSpeed", "HourlyWindSpeed") %>%
  pull(HourlyWindGustSpeed)
    
     #acf_ag_Logan$HourlyWindSpeed 
  
   acf_ag_Logan$HourlyWindSpeed <- ag_Logan %>% 
  filter(year(date) == 2021) %>%
  group_by(date,hour) %>%
  summarise(across(c("HourlyDewPointTemperature ", "HourlyDryBulbTemperature ", "HourlyPrecipitation", "HourlyRelativeHumidity", "HourlyStationPressure ", "HourlyVisibility", "HourlyWetBulbTemperature ", "HourlyWindDirection ", "HourlyWindGustSpeed", "HourlyWindSpeed") %>%
  pull(HourlyWindSpeed)
    
  


```

##MWRA Non-CSO

```{r}

#acf_ag_CR_secchi$`Total Suspended Solids (mg/L)`
 
   acf_ag_CR_secchi$`Total Suspended Solids (mg/L)` <- ag_CR_secchi %>% 
  filter(year(date) == 2021) %>%
  group_by(date,hour) %>%
  summarise(across(c("HourlyDewPointTemperature ", "HourlyDryBulbTemperature ", "HourlyPrecipitation", "HourlyRelativeHumidity", "HourlyStationPressure ", "HourlyVisibility", "HourlyWetBulbTemperature ", "HourlyWindDirection ", "HourlyWindGustSpeed", "HourlyWindSpeed") %>%
  pull(`Total Suspended Solids (mg/L)`)

#acf_ag_CR_nutrients$`Ammonium (uM)`
 
   acf_ag_CR_nutrients$`Ammonium (uM)` <- ag_CR_nutrients %>% 
  filter(year(date) == 2021) %>%
  group_by(date,hour) %>%
  summarise(across(c("HourlyDewPointTemperature ", "HourlyDryBulbTemperature ", "HourlyPrecipitation", "HourlyRelativeHumidity", "HourlyStationPressure ", "HourlyVisibility", "HourlyWetBulbTemperature ", "HourlyWindDirection ", "HourlyWindGustSpeed", "HourlyWindSpeed") %>%
  pull(`Ammonium (uM)`)
  
  #acf_ag_CR_nutrients$`Nitrate+nitrite (uM)`
 
   acf_ag_CR_nutrients$`Nitrate+nitrite (uM)` <-ag_CR_nutrients %>% 
  filter(year(date) == 2021) %>%
  group_by(date,hour) %>%
  summarise(across(c("HourlyDewPointTemperature ", "HourlyDryBulbTemperature ", "HourlyPrecipitation", "HourlyRelativeHumidity", "HourlyStationPressure ", "HourlyVisibility", "HourlyWetBulbTemperature ", "HourlyWindDirection ", "HourlyWindGustSpeed", "HourlyWindSpeed") %>%
  pull(`Nitrate+nitrite (uM)`)
  
  #acf_ag_CR_nutrients$`Phosphate (uM)`
 
   acf_ag_CR_nutrients$`Phosphate (uM)` <- ag_CR_nutrients %>% 
  filter(year(date) == 2021) %>%
  group_by(date,hour) %>%
  summarise(across(c("HourlyDewPointTemperature ", "HourlyDryBulbTemperature ", "HourlyPrecipitation", "HourlyRelativeHumidity", "HourlyStationPressure ", "HourlyVisibility", "HourlyWetBulbTemperature ", "HourlyWindDirection ", "HourlyWindGustSpeed", "HourlyWindSpeed") %>%
  pull(`Phosphate (uM)`)
  
  #acf_ag_CR_nutrients$`Total phosphorus (uM)`
 
   acf_ag_CR_nutrients$`Total phosphorus (uM)` <- ag_CR_nutrients %>% 
  filter(year(date) == 2021) %>%
  group_by(date,hour) %>%
  summarise(across(c("HourlyDewPointTemperature ", "HourlyDryBulbTemperature ", "HourlyPrecipitation", "HourlyRelativeHumidity", "HourlyStationPressure ", "HourlyVisibility", "HourlyWetBulbTemperature ", "HourlyWindDirection ", "HourlyWindGustSpeed", "HourlyWindSpeed") %>%
  pull(`Total phosphorus (uM)`)
  
    #acf_ag_CR_nutrients$`Phaeophytin (ug/L)`
 
   acf_ag_CR_nutrients$`Phaeophytin (ug/L)` <- ag_CR_nutrients %>% 
  filter(year(date) == 2021) %>%
  group_by(date,hour) %>%
  summarise(across(c("HourlyDewPointTemperature ", "HourlyDryBulbTemperature ", "HourlyPrecipitation", "HourlyRelativeHumidity", "HourlyStationPressure ", "HourlyVisibility", "HourlyWetBulbTemperature ", "HourlyWindDirection ", "HourlyWindGustSpeed", "HourlyWindSpeed") %>%
  pull(`Phaeophytin (ug/L)`)
  

  

    #acf_ag_CR_bacteria$Enterococcus

 
 acf_ag_CR_bacteria$Enterococcus <- ag_CR_bacteria %>% 
  filter(year(date) == 2021) %>%
  group_by(date,hour) %>%
  summarise(across(c("HourlyDewPointTemperature ", "HourlyDryBulbTemperature ", "HourlyPrecipitation", "HourlyRelativeHumidity", "HourlyStationPressure ", "HourlyVisibility", "HourlyWetBulbTemperature ", "HourlyWindDirection ", "HourlyWindGustSpeed", "HourlyWindSpeed") %>%
  pull(Enterococcus)
  
      #acf_ag_CR_bacteria$E_coli

 acf_ag_CR_bacteria$E_coli <- ag_CR_bacteria %>% 
  filter(year(date) == 2021) %>%
  group_by(date,hour) %>%
  summarise(across(c("HourlyDewPointTemperature ", "HourlyDryBulbTemperature ", "HourlyPrecipitation", "HourlyRelativeHumidity", "HourlyStationPressure ", "HourlyVisibility", "HourlyWetBulbTemperature ", "HourlyWindDirection ", "HourlyWindGustSpeed", "HourlyWindSpeed") %>%
  pull(E_coli)
  
     #acf_ag_CR_bacteria$coliform

 acf_ag_CR_bacteria$coliform <- ag_CR_bacteria %>% 
  filter(year(date) == 2021) %>%
  group_by(date,hour) %>%
  summarise(across(c("HourlyDewPointTemperature ", "HourlyDryBulbTemperature ", "HourlyPrecipitation", "HourlyRelativeHumidity", "HourlyStationPressure ", "HourlyVisibility", "HourlyWetBulbTemperature ", "HourlyWindDirection ", "HourlyWindGustSpeed", "HourlyWindSpeed") %>%
  pull(coliform)
  


```

##CSO

```{r}

 #acf_CAM017$MG 

 acf_CAM017$MG <- CAM017 %>% 
  filter(year(date) == 2021) %>%
  group_by(date,hour) %>%
  pull(MG)



```

#ARIMA

#COEFFICENTS OF CORRELATION

#REGRESSIONS

```{r}

ag_df_CR %>% 
  ggplot(aes(x=ph, y=phy, color = "Points")) + 
  geom_point() +
  geom_hline(aes(yintercept = mean(phy), color = "Mean Phy Trendline"), linetype = "dashed") +
  geom_vline(aes(xintercept = mean(ph), color = "Mean Ph Trendline"), linetype = "dashed") +
  geom_smooth(aes(color = "Best Fit Line"), method = "lm") +
  scale_color_manual(values = c("Points" = "red", 
                                 "Mean Phy Trendline" = "blue", 
                                 "Best Fit Line" = "purple", 
                                 "Mean Ph Trendline" = "orange"), 
                     breaks = c("Points", "Mean Phy Trendline", 
                                "Best Fit Line", "Mean Ph Trendline"),
                     labels = c("Points", "Mean Phy Trendline", 
                                "Best Fit Line", "Mean Ph Trendline")) +
  guides(color = guide_legend(override.aes = list(
    shape = c(19, NA, NA, NA),
    linetype = c("blank", "dotted", "solid", "dotted")
  ))) +
  ggtitle("pH vs. Phycocanin (RFU)") +
  labs(color = "Legend",
       x = "pH",
       y = "Phycocanin (RFU")


ag_df_CR %>% 
  ggplot(aes(x=ph, y=phy, color = "Points")) + 
  geom_point() +
  geom_hline(aes(yintercept = mean(phy), color = "Mean Phycocanin Trendline"), linetype = "dashed") +
  geom_vline(aes(xintercept = mean(ph), color = "Mean pH Trendline"), linetype = "dashed") +
  geom_smooth(aes(color = "Best Fit Line"), method = "lm") +
  scale_color_manual(values = c("Points" = "red", 
                                 "Mean pH Trendline" = "blue", 
                                 "Best Fit Line" = "purple", 
                                 "Mean Phycocanin Trendline" = "orange"), 
                     breaks = c("Points", "Mean Phycocanin Trendline", 
                                "Best Fit Line", "Mean pH Trendline"),
                     labels = c("Points", "Mean Phycocanin Trendline", 
                                "Best Fit Line", "Mean pH Trendline")) +
  guides(color = guide_legend(override.aes = list(
    shape = c(19, NA, NA, NA),
    linetype = c("blank", "dotted", "solid", "dotted")
  ))) +
  ggtitle("pH vs. Phycocanin (RFU)") +
  labs(color = "Legend",
       x = "pH",
       y = "Phycocanin (RFU")



```

##PLOTS W/ CORR \> 0.5

```{r}
phphy
dochl
turbphy



ag_df_CR %>% 
  ggplot(aes(x=ph, y=phy, color = "Points")) + 
  geom_point() +
  geom_hline(aes(yintercept = mean(ag_df_CR$phy), color = "Phy Mean Trendline"), linetype = "dashed") +
  geom_hline(aes(yintercept = median(ag_df_CR$phy), color = "Phy Median Trendline"), linetype = "dashed") +
  geom_smooth(aes(color = "Best Fit Line"), method = "lm", ) +
  geom_vline(aes(xintercept = mean(ag_df_CR$ph), color = "Ph Mean Trendline"), linetype = "dashed") +
  geom_vline(aes(xintercept = median(ag_df_CR$ph), color = "Ph Median Trendline"), linetype = "dashed") +
  scale_color_manual(values = c("Points" = "red", 
                                 "Phy Mean Trendline" = "blue", "Phy Median Trendline" = "green", 
                                 "Best Fit Line" = "purple", 
                                 "Ph Mean Trendline" = "orange", "Ph Median Trendline" = "brown"), 
                     breaks = c("Points", "Phy Mean Trendline", "Phy Median Trendline", 
                                "Best Fit Line", "Ph Mean Trendline", "Ph Median Trendline"),
                     labels = c("Points", "Phy Mean Trendline", "Phy Median Trendline", 
                                "Best Fit Line", "Ph Mean Trendline", "Ph Median Trendline")) +
  guides(color = guide_legend(override.aes = list(
    shape = c(19, NA, NA, NA, NA, NA),
    linetype = c(1, 0, 0, 0, 0 ,0)
  ))) +
  ggtitle("Ph vs. Phy") +
  labs(color = "Legend Title")






```

#PLOTS

```{r}

ag_df_CR <- na.omit(ag_df_CR)
ag_Logan <- na.omit(ag_Logan)
ag_CR_nutrients
ag_CR_secchi
ag_CR_bacteria


#ag_CR_secchi

ag_CR_secchi$`Total Suspended Solids (mg/L)`

#ag_CR_nutrients 

ag_CR_nutrients$`Ammonium (uM)`
ag_CR_nutrients$`Nitrate+nitrite (uM)`
ag_CR_nutrients$`Phosphate (uM)`
ag_CR_nutrients$`Total phosphorus (uM)`
ag_CR_nutrients$`Phaeophytin (ug/L)`

#ag_CR_bacteria

ag_CR_bacteria$Enterococcus
ag_CR_bacteria$E_coli
ag_CR_bacteria$coliform


#Ph MEDIAN AND MEAN ARE THE SAME?


#PH VS. PHY

ag_df_CR %>% 
  ggplot(aes(x=ph, y=phy, color = "Points")) + 
  geom_point() +
  geom_hline(aes(yintercept = mean(ag_df_CR$phy), color = "Phy Mean Trendline"), linetype = "dashed") +
  geom_hline(aes(yintercept = median(ag_df_CR$phy), color = "Phy Median Trendline"), linetype = "dashed") +
  geom_smooth(aes(color = "Best Fit Line"), method = "lm", ) +
  geom_vline(aes(xintercept = mean(ag_df_CR$ph), color = "Ph Mean Trendline"), linetype = "dashed") +
  geom_vline(aes(xintercept = median(ag_df_CR$ph), color = "Ph Median Trendline"), linetype = "dashed") +
  scale_color_manual(values = c("Points" = "red", 
                                 "Phy Mean Trendline" = "blue", "Phy Median Trendline" = "green", 
                                 "Best Fit Line" = "purple", 
                                 "Ph Mean Trendline" = "orange", "Ph Median Trendline" = "brown"), 
                     breaks = c("Points", "Phy Mean Trendline", "Phy Median Trendline", 
                                "Best Fit Line", "Ph Mean Trendline", "Ph Median Trendline"),
                     labels = c("Points", "Phy Mean Trendline", "Phy Median Trendline", 
                                "Best Fit Line", "Ph Mean Trendline", "Ph Median Trendline")) +
  guides(color = guide_legend(override.aes = list(
    shape = c(19, NA, NA, NA, NA, NA),
    linetype = c(1, 0, 0, 0, 0 ,0)
  ))) +
  ggtitle("Ph vs. Phy") +
  labs(color = "Legend Title")

#PH VS. CHL


ag_df_CR %>% 
  ggplot(aes(x=ph, y=chl, color = "Points")) + 
  geom_point() +
  geom_hline(aes(yintercept = mean(ag_df_CR$chl), color = "Chl Mean Trendline"), linetype = "dashed") +
  geom_hline(aes(yintercept = median(ag_df_CR$chl), color = "Chl Median Trendline"), linetype = "dashed") +
  geom_smooth(aes(color = "Best Fit Line"), method = "lm", ) +
  geom_vline(aes(xintercept = mean(ag_df_CR$ph), color = "Ph Mean Trendline"), linetype = "dashed") +
  geom_vline(aes(xintercept = median(ag_df_CR$ph), color = "Ph Median Trendline"), linetype = "dashed") +
  scale_color_manual(values = c("Points" = "red", 
                                 "Chl Mean Trendline" = "blue", "Chl Median Trendline" = "green", 
                                 "Best Fit Line" = "purple", 
                                 "Ph Mean Trendline" = "orange", "Ph Median Trendline" = "brown"), 
                     breaks = c("Points", "Chl Mean Trendline", "Chl Median Trendline", 
                                "Best Fit Line", "Ph Mean Trendline", "Ph Median Trendline"),
                     labels = c("Points", "Chl Mean Trendline", "Chl Median Trendline", 
                                "Best Fit Line", "Ph Mean Trendline", "Ph Median Trendline")) +
  guides(color = guide_legend(override.aes = list(
    shape = c(19, NA, NA, NA, NA, NA),
    linetype = c(1, 1, 1, 1, 1 ,1)
  ))) +
  ggtitle("Ph vs. Chl") +
  labs(color = "Legend Title")


# Ph vs. Del_phy
ag_df_CR %>% 
  ggplot(aes(x=ph, y=del_phy, color = "Points")) + 
  geom_point() +
  geom_hline(aes(yintercept = mean(ag_df_CR$del_phy), color = "Del_phy Mean Trendline"), linetype = "dashed") +
  geom_hline(aes(yintercept = median(ag_df_CR$del_phy), color = "Del_phy Median Trendline"), linetype = "dashed") +
  geom_smooth(aes(color = "Best Fit Line"), method = "lm", se = FALSE) +
  geom_vline(aes(xintercept = mean(ag_df_CR$ph), color = "Ph Mean Trendline"), linetype = "dashed") +
  geom_vline(aes(xintercept = median(ag_df_CR$ph), color = "Ph Median Trendline"), linetype = "dashed") +
  scale_color_manual(values = c("Points" = "red", 
                                 "Del_phy Mean Trendline" = "blue", "Del_phy Median Trendline" = "green", 
                                 "Best Fit Line" = "purple", 
                                 "Ph Mean Trendline" = "orange", "Ph Median Trendline" = "brown"), 
                     breaks = c("Points", "Del_phy Mean Trendline", "Del_phy Median Trendline", 
                                "Best Fit Line", "Ph Mean Trendline", "Ph Median Trendline"),
                     labels = c("Points", "Del_phy Mean Trendline", "Del_phy Median Trendline", 
                                "Best Fit Line", "Ph Mean Trendline", "Ph Median Trendline")) +
  guides(color = guide_legend(override.aes = list(
    shape = c(19, NA, NA, NA, NA, NA),
    linetype = c(0, 0, 0, 0, 1, 1)
  ))) +
  ggtitle("Ph vs. Del_phy") +
  labs(color = "Legend Title")


# Chl vs. Phy
ag_df_CR %>% 
  ggplot(aes(x=chl, y=phy, color = "Points")) + 
  geom_point() +
  geom_hline(aes(yintercept = mean(ag_df_CR$phy), color = "Phy Mean Trendline"), linetype = "dashed") +
  geom_hline(aes(yintercept = median(ag_df_CR$phy), color = "Phy Median Trendline"), linetype = "dashed") +
  geom_smooth(aes(color = "Best Fit Line"), method = "lm", se = FALSE) +
  geom_vline(aes(xintercept = mean(ag_df_CR$chl), color = "Chl Mean Trendline"), linetype = "dashed") +
  geom_vline(aes(xintercept = median(ag_df_CR$chl), color = "Chl Median Trendline"), linetype = "dashed") +
  scale_color_manual(values = c("Points" = "red", 
                                 "Phy Mean Trendline" = "blue", "Phy Median Trendline" = "green", 
                                 "Best Fit Line" = "purple", 
                                 "Chl Mean Trendline" = "orange", "Chl Median Trendline" = "brown"), 
                     breaks = c("Points", "Phy Mean Trendline", "Phy Median Trendline", 
                                "Best Fit Line", "Chl Mean Trendline", "Chl Median Trendline"),
                     labels = c("Points", "Phy Mean Trendline", "Phy Median Trendline", 
                                "Best Fit Line", "Chl Mean Trendline", "Chl Median Trendline")) +
  guides(color = guide_legend(override.aes = list(
    shape = c(19, NA, NA, NA, NA, NA),
    linetype = c(0, 1, 1, 1, 1 ,1)
  ))) +
  ggtitle("Chl vs. Phy") +
  labs(color = "Legend Title")

# Celsius vs. Phy
ag_df_CR %>% 
  ggplot(aes(x=Celsius, y=phy, color = "Points")) + 
  geom_point() +
  geom_hline(aes(yintercept = mean(ag_df_CR$phy), color = "Phy Mean Trendline"), linetype = "dashed") +
  geom_hline(aes(yintercept = median(ag_df_CR$phy), color = "Phy Median Trendline"), linetype = "dashed") +
  geom_smooth(aes(color = "Best Fit Line"), method = "lm", se = FALSE) +
  geom_vline(aes(xintercept = mean(ag_df_CR$Celsius), color = "Celsius Mean Trendline"), linetype = "dashed") +
  geom_vline(aes(xintercept = median(ag_df_CR$Celsius), color = "Celsius Median Trendline"), linetype = "dashed") +
  scale_color_manual(values = c("Points" = "red", 
                                 "Phy Mean Trendline" = "blue", "Phy Median Trendline" = "green", 
                                 "Best Fit Line" = "purple", 
                                 "Celsius Mean Trendline" = "orange", "Celsius Median Trendline" = "brown"), 
                     breaks = c("Points", "Phy Mean Trendline", "Phy Median Trendline", 
                                "Best Fit Line", "Celsius Mean Trendline", "Celsius Median Trendline"),
                     labels = c("Points", "Phy Mean Trendline", "Phy Median Trendline", 
                                "Best Fit Line", "Celsius Mean Trendline", "Celsius Median Trendline")) +
  guides(color = guide_legend(override.aes = list(
    shape = c(19, NA, NA, NA, NA, NA),
    linetype = c(0, 1, 1, 1, 1 ,1)
  ))) +
  ggtitle("Celsius vs. Phy") +
  labs(color = "Legend Title")

# Celsius vs. Chl
ag_df_CR %>% 
  ggplot(aes(x=Celsius, y=chl, color = "Points")) + 
  geom_point() +
  geom_hline(aes(yintercept = mean(ag_df_CR$chl), color = "Chl Mean Trendline"), linetype = "dashed") +
  geom_hline(aes(yintercept = median(ag_df_CR$chl), color = "Chl Median Trendline"), linetype = "dashed") +
  geom_smooth(aes(color = "Best Fit Line"), method = "lm", se = FALSE) +
  geom_vline(aes(xintercept = mean(ag_df_CR$Celsius), color = "Celsius Mean Trendline"), linetype = "dashed") +
geom_vline(aes(xintercept = median(ag_df_CR$Celsius), color = "Celsius Median Trendline"), linetype = "dashed") +
scale_color_manual(values = c("Points" = "red",
"Chl Mean Trendline" = "blue", "Chl Median Trendline" = "green",
"Best Fit Line" = "purple",
"Celsius Mean Trendline" = "orange", "Celsius Median Trendline" = "brown"),
breaks = c("Points", "Chl Mean Trendline", "Chl Median Trendline",
"Best Fit Line", "Celsius Mean Trendline", "Celsius Median Trendline"),
labels = c("Points", "Chl Mean Trendline", "Chl Median Trendline",
"Best Fit Line", "Celsius Mean Trendline", "Celsius Median Trendline")) +
guides(color = guide_legend(override.aes = list(
shape = c(19, NA, NA, NA, NA, NA),
linetype = c(0, 0, 0, 1, 1 ,1)
))) +
ggtitle("Celsius vs. Chl") +
labs(color = "Legend Title")


#Celsius vs. Del_phy

ag_df_CR %>%
ggplot(aes(x=Celsius, y=del_phy, color = "Points")) +
geom_point() +
geom_hline(aes(yintercept = mean(ag_df_CR$del_phy), color = "Del_phy Mean Trendline"), linetype = "dashed") +
geom_hline(aes(yintercept = median(ag_df_CR$del_phy), color = "Del_phy Median Trendline"), linetype = "dashed") +
geom_smooth(aes(color = "Best Fit Line"), method = "lm", se = FALSE) +
geom_vline(aes(xintercept = mean(ag_df_CR$Celsius), color = "Celsius Mean Trendline"), linetype = "dashed") +
geom_vline(aes(xintercept = median(ag_df_CR$Celsius), color = "Celsius Median Trendline"), linetype = "dashed") +
scale_color_manual(values = c("Points" = "red",
"Del_phy Mean Trendline" = "blue", "Del_phy Median Trendline" = "green",
"Best Fit Line" = "purple",
"Celsius Mean Trendline" = "orange", "Celsius Median Trendline" = "brown"),
breaks = c("Points", "Del_phy Mean Trendline", "Del_phy Median Trendline",
"Best Fit Line", "Celsius Mean Trendline", "Celsius Median Trendline"),
labels = c("Points", "Del_phy Mean Trendline", "Del_phy Median Trendline",
"Best Fit Line", "Celsius Mean Trendline", "Celsius Median Trendline")) +
guides(color = guide_legend(override.aes = list(
shape = c(19, NA, NA, NA, NA, NA),
linetype = c(0, 0, 0, 1, 1 ,1)
))) +
ggtitle("Celsius vs. Del_phy") +
labs(color = "Legend Title")

#Spcond vs. Phy
ag_df_CR %>%
ggplot(aes(x=spcond, y=phy, color = "Points")) +
geom_point() +
geom_hline(aes(yintercept = mean(ag_df_CR$phy), color = "Phy Mean Trendline"), linetype = "dashed") +
geom_hline(aes(yintercept = median(ag_df_CR$phy), color = "Phy Median Trendline"), linetype = "dashed") +
geom_smooth(aes(color = "Best Fit Line"), method = "lm", se = FALSE) +
geom_vline(aes(xintercept = mean(ag_df_CR$spcond), color = "Spcond Mean Trendline"), linetype = "dashed") +
geom_vline(aes(xintercept = median(ag_df_CR$spcond), color = "Spcond Median Trendline"), linetype = "dashed") +
scale_color_manual(values = c("Points" = "red",
"Phy Mean Trendline" = "blue", "Phy Median Trendline" = "green",
"Best Fit Line" = "purple",
"Spcond Mean Trendline" = "orange", "Spcond Median Trendline" = "brown"),
breaks = c("Points", "Phy Mean Trendline", "Phy Median Trendline",
"Best Fit Line", "Spcond Mean Trendline", "Spcond Median Trendline"),
labels = c("Points", "Phy Mean Trendline", "Phy Median Trendline",
"Best Fit Line", "Spcond Mean Trendline", "Spcond Median Trendline")) +
guides(color = guide_legend(override.aes = list(
shape = c(19, NA, NA, NA, NA, NA),
linetype = c(0, 1, 1, 1, 1 ,1)
))) +
ggtitle("Spcond vs. Phy") +
labs(color = "Legend Title")

#Spcond vs. Chl
ag_df_CR %>%
ggplot(aes(x=spcond, y=chl, color = "Points")) +
geom_point() +
geom_hline(aes(yintercept = mean(ag_df_CR$chl), color = "Chl Mean Trendline"), linetype = "dashed") +
geom_hline(aes(yintercept = median(ag_df_CR$chl), color = "Chl Median Trendline"), linetype = "dashed") +
geom_smooth(aes(color = "Best Fit Line"), method = "lm", se = FALSE) +
geom_vline(aes(xintercept = mean(ag_df_CR$spcond), color = "Spcond Mean Trendline"), linetype = "dashed") +
geom_vline(aes(xintercept = median(ag_df_CR$spcond), color = "Spcond Median Trendline"), linetype = "dashed") +
scale_color_manual(values = c("Points" = "red",
"Chl Mean Trendline" = "blue", "Chl Median Trendline" = "green",
"Best Fit Line" = "purple",
"Spcond Mean Trendline" = "orange", "Spcond Median Trendline" = "brown"),
breaks = c("Points", "Chl Mean Trendline", "Chl Median Trendline",
"Best Fit Line", "Spcond Mean Trendline", "Spcond Median Trendline"),
labels = c("Points", "Chl Mean Trendline", "Chl Median Trendline",
"Best Fit Line", "Spcond Mean Trendline", "Spcond Median Trendline")) +
guides(color = guide_legend(override.aes = list(
shape = c(19, NA, NA, NA, NA, NA),
linetype = c(0, 0, 0, 1, 1 ,1)
))) +
ggtitle("Spcond vs. Chl") +
labs(color = "Legend Title")


#Spcond vs. Del_phy

ag_df_CR %>%
ggplot(aes(x=spcond, y=del_phy, color = "Points")) +
geom_point() +
geom_hline(aes(yintercept = mean(ag_df_CR$del_phy), color = "Del_phy Mean Trendline"), linetype = "dashed") +
geom_hline(aes(yintercept = median(ag_df_CR$del_phy), color = "Del_phy Median Trendline"), linetype = "dashed") +
geom_smooth(aes(color = "Best Fit Line"), method = "lm", se = FALSE) +
geom_vline(aes(xintercept = mean(ag_df_CR$spcond), color = "Spcond Mean Trendline"), linetype = "dashed") +
geom_vline(aes(xintercept = median(ag_df_CR$spcond), color = "Spcond Median Trendline"), linetype = "dashed") +
scale_color_manual(values = c("Points" = "red",
"Del_phy Mean Trendline" = "blue", "Del_phy Median Trendline" = "green",
"Best Fit Line" = "purple",
"Spcond Mean Trendline" = "orange", "Spcond Median Trendline" = "brown"),
breaks = c("Points", "Del_phy Mean Trendline", "Del_phy Median Trendline",
"Best Fit Line", "Spcond Mean Trendline", "Spcond Median Trendline"),
labels = c("Points", "Del_phy Mean Trendline", "Del_phy Median Trendline",
"Best Fit Line", "Spcond Mean Trendline", "Spcond Median Trendline")) +
guides(color = guide_legend(override.aes = list(
shape = c(19, NA, NA, NA, NA, NA),
linetype = c(0, 0, 0, 1, 1 ,1)
))) +
ggtitle("Spcond vs. Del_phy") +
labs(color = "Legend Title")

#Do vs. Phy
ag_df_CR %>%
ggplot(aes(x=do, y=phy, color = "Points")) +
geom_point() +
geom_hline(aes(yintercept = mean(ag_df_CR$phy), color = "Phy Mean Trendline"), linetype = "dashed") +
geom_hline(aes(yintercept = median(ag_df_CR$phy), color = "Phy Median Trendline"), linetype = "dashed") +
geom_smooth(aes(color = "Best Fit Line"), method = "lm", se = FALSE) +
geom_vline(aes(xintercept = mean(ag_df_CR$do), color = "Do Mean Trendline"), linetype = "dashed") +
geom_vline(aes(xintercept = median(ag_df_CR$do), color = "Do Median Trendline"), linetype = "dashed") +
scale_color_manual(values = c("Points" = "red",
"Phy Mean Trendline" = "blue", "Phy Median Trendline" = "green",
"Best Fit Line" = "purple",
"Do Mean Trendline" = "orange", "Do Median Trendline" = "brown"),
breaks = c("Points", "Phy Mean Trendline", "Phy Median Trendline",
"Best Fit Line", "Do Mean Trendline", "Do Median Trendline"),
labels = c("Points", "Phy Mean Trendline", "Phy Median Trendline",
"Best Fit Line", "Do Mean Trendline", "Do Median Trendline")) +
guides(color = guide_legend(override.aes = list(
shape = c(19, NA, NA, NA, NA, NA),
linetype = c(0, 1, 1, 1, 1 ,1)
))) +
ggtitle("Do vs. Phy") +
labs(color = "Legend Title")

#Do vs. Chl
ag_df_CR %>%
ggplot(aes(x=do, y=chl, color = "Points")) +
geom_point() +
geom_hline(aes(yintercept = mean(ag_df_CR$chl), color = "Chl Mean Trendline"), linetype = "dashed") +
geom_hline(aes(yintercept = median(ag_df_CR$chl), color = "Chl Median Trendline"), linetype = "dashed") +
geom_smooth(aes(color = "Best Fit Line"), method = "lm", se = FALSE) +
geom_vline(aes(xintercept = mean(ag_df_CR$do), color = "Do Mean Trendline"), linetype = "dashed
") +
geom_vline(aes(xintercept = median(ag_df_CR$do), color = "Do Median Trendline"), linetype = "dashed") +
scale_color_manual(values = c("Points" = "red",
"Chl Mean Trendline" = "blue", "Chl Median Trendline" = "green",
"Best Fit Line" = "purple",
"Do Mean Trendline" = "orange", "Do Median Trendline" = "brown"),
breaks = c("Points", "Chl Mean Trendline", "Chl Median Trendline",
"Best Fit Line", "Do Mean Trendline", "Do Median Trendline"),
labels = c("Points", "Chl Mean Trendline", "Chl Median Trendline",
"Best Fit Line", "Do Mean Trendline", "Do Median Trendline")) +
guides(color = guide_legend(override.aes = list(
shape = c(19, NA, NA, NA, NA, NA),
linetype = c(0, 0, 0, 1, 1 ,1)
))) +
ggtitle("Do vs. Chl") +
labs(color = "Legend Title")

#Do vs. Del_phy
ag_df_CR %>%
ggplot(aes(x=do, y=del_phy, color = "Points")) +
geom_point() +
geom_hline(aes(yintercept = mean(ag_df_CR$del_phy), color = "Del_phy Mean Trendline"), linetype = "dashed") +
geom_hline(aes(yintercept = median(ag_df_CR$del_phy), color = "Del_phy Median Trendline"), linetype = "dashed") +
geom_smooth(aes(color = "Best Fit Line"), method = "lm", se = FALSE) +
geom_vline(aes(xintercept = mean(ag_df_CR$do), color = "Do Mean Trendline"), linetype = "dashed") +
geom_vline(aes(xintercept = median(ag_df_CR$do), color = "Do Median Trendline"), linetype = "dashed") +
scale_color_manual(values = c("Points" = "red",
"Del_phy Mean Trendline" = "blue", "Del_phy Median Trendline" = "green",
"Best Fit Line" = "purple",
"Do Mean Trendline" = "orange", "Do Median Trendline" = "brown"),
breaks = c("Points", "Del_phy Mean Trendline", "Del_phy Median Trendline",
"Best Fit Line", "Do Mean Trendline", "Do Median Trendline"),
labels = c("Points", "Del_phy Mean Trendline", "Del_phy Median Trendline",
"Best Fit Line", "Do Mean Trendline", "Do Median Trendline")) +
guides(color = guide_legend(override.aes = list(
shape = c(19, NA, NA, NA, NA, NA),
linetype = c(0, 0, 0, 1, 1 ,1)
))) +
ggtitle("Do vs. Del_phy") +
labs(color = "Legend Title")

#Turb vs. Chl
ag_df_CR %>%
ggplot(aes(x=turb, y=chl, color = "Points")) +
geom_point() +
geom_hline(aes(yintercept = mean(ag_df_CR$chl), color = "Chl Mean Trendline"), linetype = "dashed") +
geom_hline(aes(yintercept = median(ag_df_CR$chl), color = "Chl Median Trendline"), linetype = "dashed") +
geom_smooth(aes(color = "Best Fit Line"), method = "lm", se = FALSE) +
geom_vline(aes(xintercept = mean(ag_df_CR$turb), color = "Turb Mean Trendline"), linetype = "dashed") +
geom_vline(aes(xintercept = median(ag_df_CR$turb), color = "Turb Median Trendline"), linetype = "dashed") +
scale_color_manual(values = c("Points" = "red",
"Chl Mean Trendline" = "blue", "Chl Median Trendline" = "green",
"Best Fit Line" = "purple",
"Turb Mean Trendline" = "orange", "Turb Median Trendline" = "brown"),
breaks = c("Points", "Chl Mean Trendline", "Chl Median Trendline",
"Best Fit Line", "Turb Mean Trendline", "Turb Median Trendline"),
labels = c("Points", "Chl Mean Trendline", "Chl Median Trendline",
"Best Fit Line", "Turb Mean Trendline", "Turb Median Trendline")) +
guides(color = guide_legend(override.aes = list(
shape = c(19, NA, NA, NA, NA, NA),
linetype = c(0, 0, 0, 1, 1 ,1)
))) +
ggtitle("Turb vs. Chl") +
labs(color = "Legend Title")


#Turb vs. Phy
ag_df_CR %>%
ggplot(aes(x=turb, y=phy, color = "Points")) +
geom_point() +
geom_hline(aes(yintercept = mean(ag_df_CR$phy), color = "Phy Mean Trendline"), linetype = "dashed") +
geom_hline(aes(yintercept = median(ag_df_CR$phy), color = "Phy Median Trendline"), linetype = "dashed") +
geom_smooth(aes(color = "Best Fit Line"), method = "lm", se = FALSE) +
geom_vline(aes(xintercept = mean(ag_df_CR$turb), color = "Turb Mean Trendline"), linetype = "dashed") +
geom_vline(aes(xintercept = median(ag_df_CR$turb), color = "Turb Median Trendline"), linetype = "dashed") +
scale_color_manual(values = c("Points" = "red",
"Phy Mean Trendline" = "blue", "Phy Median Trendline" = "green",
"Best Fit Line" = "purple",
"Turb Mean Trendline" = "orange", "Turb Median Trendline" = "brown"),
breaks = c("Points", "Phy Mean Trendline", "Phy Median Trendline",
"Best Fit Line", "Turb Mean Trendline", "Turb Median Trendline"),
labels = c("Points", "Phy Mean Trendline", "Phy Median Trendline",
"Best Fit Line", "Turb Mean Trendline", "Turb Median Trendline")) +
guides(color = guide_legend(override.aes = list(
shape = c(19, NA, NA, NA, NA, NA),
linetype = c(0, 1, 1, 1, 1 ,1)
))) +
ggtitle("Turb vs. Phy") +
labs(color = "Legend Title")

#Turb vs. Del_phy
ag_df_CR %>%
ggplot(aes(x=turb, y=del_phy, color = "Points")) +
geom_point() +
geom_hline(aes(yintercept = mean(ag_df_CR$del_phy), color = "Del_phy Mean Trendline"), linetype = "dashed") +
geom_hline(aes(yintercept = median(ag_df_CR$del_phy), color = "Del_phy Median Trendline"), linetype = "dashed") +
geom_smooth(aes(color = "Best Fit Line"), method = "lm", se = FALSE) +
geom_vline(aes(xintercept = mean(ag_df_CR$turb), color = "Turb Mean Trendline"), linetype = "dashed") +
geom_vline(aes(xintercept = median(ag_df_CR$turb), color = "Turb Median Trendline"), linetype = "dashed") +
scale_color_manual(values = c("Points" = "red",
"Del_phy Mean Trendline" = "blue", "Del_phy Median Trendline" = "green",
"Best Fit Line" = "purple",
"Turb Mean Trendline" = "orange", "Turb Median Trendline" = "brown"),
breaks = c("Points", "Del_phy Mean Trendline", "Del_phy Median Trendline",
"Best Fit Line", "Turb Mean Trendline", "Turb Median Trendline"),
labels = c("Points", "Del_phy Mean Trendline", "Del_phy Median Trendline",
"Best Fit Line", "Turb Mean Trendline", "Turb Median Trendline")) +
guides(color = guide_legend(override.aes = list(
shape = c(19, NA, NA, NA, NA, NA),
linetype = c(0, 1, 1, 1, 1 ,1)
))) +
ggtitle("Turb vs. Del_phy") +
labs(color = "Legend Title")

#Salinity vs. Phy
ag_df_CR %>%
ggplot(aes(x=Salinity, y=phy, color = "Points")) +
geom_point() +
geom_hline(aes(yintercept = mean(ag_df_CR$phy), color = "Phy Mean Trendline"), linetype = "dashed") +
geom_hline(aes(yintercept = median(ag_df_CR$phy), color = "Phy Median Trendline"), linetype = "dashed") +
geom_smooth(aes(color = "Best Fit Line"), method = "lm", se = FALSE) +
geom_vline(aes(xintercept = mean(ag_df_CR$Salinity), color = "Salinity Mean Trendline"), linetype = "dashed") +
geom_vline(aes(xintercept = median(ag_df_CR$Salinity), color = "Salinity Median Trendline"), linetype = "dashed") +
scale_color_manual(values = c("Points" = "red",
"Phy Mean Trendline" = "blue", "Phy Median Trendline" = "green",
"Best Fit Line" = "purple",
"Salinity Mean Trendline" = "orange", "Salinity Median Trendline" = "brown"),
breaks = c("Points", "Phy Mean Trendline", "Phy Median Trendline",
"Best Fit Line", "Salinity Mean Trendline", "Salinity Median Trendline"),
labels = c("Points", "Phy Mean Trendline", "Phy Median Trendline",
"Best Fit Line", "Salinity Mean Trendline", "Salinity Median Trendline")) +
guides(color = guide_legend(override.aes = list(
shape = c(19, NA, NA, NA, NA, NA),
linetype = c(0, 0, 0, 1, 1 ,1)
))) +
ggtitle("Salinity vs. Phy") +
labs(color = "Legend Title")

#Salinity vs. Chl
ag_df_CR %>%
ggplot(aes(x=Salinity, y=chl, color = "Points")) +
geom_point() +
geom_hline(aes(yintercept = mean(ag_df_CR$chl), color = "Chl Mean Trendline"), linetype = "dashed") +
geom_hline(aes(yintercept = median(ag_df_CR$chl), color = "Chl Median Trendline"), linetype = "dashed") +
geom_smooth(aes(color = "Best Fit Line"), method = "lm", se = FALSE) +
geom_vline(aes(xintercept = mean(ag_df_CR$Salinity), color = "Salinity Mean Trendline"), linetype = "dashed") +
geom_vline(aes(xintercept = median(ag_df_CR$Salinity), color = "Salinity Median Trendline"), linetype = "dashed") +
scale_color_manual(values = c("Points" = "red",
"Chl Mean Trendline" = "blue", "Chl Median Trendline" = "green",
"Best Fit Line" = "purple",
"Salinity Mean Trendline" = "orange", "Salinity Median Trendline" = "brown"),
breaks = c("Points", "Chl Mean Trendline", "Chl Median Trendline",
"Best Fit Line", "Salinity Mean Trendline", "Salinity Median Trendline"),
labels = c("Points", "Chl Mean Trendline", "Chl Median Trendline",
"Best Fit Line", "Salinity Mean Trendline", "Salinity Median Trendline")) +
guides(color = guide_legend(override.aes = list(
shape = c(19, NA, NA, NA, NA, NA),
linetype = c(0, 0, 0, 1, 1 ,1)
))) +
ggtitle("Salinity vs. Chl") +
labs(color = "Legend Title")



#Salinity vs. Del_phy

ag_df_CR %>%
ggplot(aes(x=Salinity, y=del_phy, color = "Points")) +
geom_point() +
geom_hline(aes(yintercept = mean(ag_df_CR$del_phy), color = "Del_phy Mean Trendline"), linetype = "dashed") +
geom_hline(aes(yintercept = median(ag_df_CR$del_phy), color = "Del_phy Median Trendline"), linetype = "dashed") +
geom_smooth(aes(color = "Best Fit Line"), method = "lm", se = FALSE) +
geom_vline(aes(xintercept = mean(ag_df_CR$Salinity), color = "Salinity Mean Trendline"), linetype = "dashed") +
geom_vline(aes(xintercept = median(ag_df_CR$Salinity), color = "Salinity Median Trendline"), linetype = "dashed") +
scale_color_manual(values = c("Points" = "red",
"Del_phy Mean Trendline" = "blue", "Del_phy Median Trendline" = "green",
"Best Fit Line" = "purple",
"Salinity Mean Trendline" = "orange", "Salinity Median Trendline" = "brown"),
breaks = c("Points", "Del_phy Mean Trendline", "Del_phy Median Trendline",
"Best Fit Line", "Salinity Mean Trendline", "Salinity Median Trendline"),
labels = c("Points", "Del_phy Mean Trendline", "Del_phy Median Trendline",
"Best Fit Line", "Salinity Mean Trendline", "Salinity Median Trendline")) +
guides(color = guide_legend(override.aes = list(
shape = c(19, NA, NA, NA, NA, NA),
linetype = c(0, 0, 0, 1, 1 ,1)
))) +
ggtitle("Salinity vs. Del_phy") +
labs(color = "Legend Title")


# Phy vs. Chl
ag_df_CR %>% 
  ggplot(aes(x=phy, y=chl, color = "Points")) + 
  geom_point() +
  geom_hline(aes(yintercept = mean(ag_df_CR$chl), color = "Chl Mean Trendline"), linetype = "dashed") +
  geom_hline(aes(yintercept = median(ag_df_CR$chl), color = "Chl Median Trendline"), linetype = "dashed") +
  geom_smooth(aes(color = "Best Fit Line"), method = "lm", se = FALSE) +
  geom_vline(aes(xintercept = mean(ag_df_CR$phy), color = "Phy Mean Trendline"), linetype = "dashed") +
  geom_vline(aes(xintercept = median(ag_df_CR$phy), color = "Phy Median Trendline"), linetype = "dashed") +
  scale_color_manual(values = c("Points" = "red", 
                                 "Chl Mean Trendline" = "blue", "Chl Median Trendline" = "green", 
                                 "Best Fit Line" = "purple", 
                                 "Phy Mean Trendline" = "orange", "Phy Median Trendline" = "brown"), 
                     # breaks = c("Points", "Chl Mean Trendline", "Chl Median Trendline", 
                     #            "Best Fit Line", "Phy Mean Trendline", "Phy Median Trendline"),
                     labels = c("Points", "Chl Mean Trendline", "Chl Median Trendline", 
                                "Best Fit Line", "Phy Mean Trendline", "Phy Median Trendline")) +
  guides(color = guide_legend(override.aes = list(
    shape = c(19, NA, NA, NA, NA, NA),
    linetype = c(0, 0, 0, 1, 1 ,1)
  ))) +
  ggtitle("Phy vs. Chl") +
  labs(color = "Legend Title")

# Phy vs. Del_phy
ag_df_CR %>% 
  ggplot(aes(x=phy, y=del_phy, color = "Points")) + 
  geom_point() +
  geom_hline(aes(yintercept = mean(ag_df_CR$del_phy), color = "Del_phy Mean Trendline"), linetype = "dashed") +
  geom_hline(aes(yintercept = median(ag_df_CR$del_phy), color = "Del_phy Median Trendline"), linetype = "dashed") +
  geom_smooth(aes(color = "Best Fit Line"), method = "lm", se = FALSE) +
  geom_vline(aes(xintercept = mean(ag_df_CR$phy), color = "Phy Mean Trendline"), linetype = "dashed") +
  geom_vline(aes(xintercept = median(ag_df_CR$phy), color = "Phy Median Trendline"), linetype = "dashed") +
  scale_color_manual(values = c("Points" = "red", 
                                 "Del_phy Mean Trendline" = "blue", "Del_phy Median Trendline" = "green", 
                                 "Best Fit Line" = "purple", 
                                 "Phy Mean Trendline" = "orange", "Phy Median Trendline" = "brown"), 
                     breaks = c("Points", "Del_phy Mean Trendline", "Del_phy Median Trendline", 
                                "Best Fit Line", "Phy Mean Trendline", "Phy Median Trendline"),
                     labels = c("Points", "Del_phy Mean Trendline", "Del_phy Median Trendline", 
                                "Best Fit Line", "Phy Mean Trendline", "Phy Median Trendline")) +
  # guides(color = guide_legend(override.aes = list(
  #   shape = c(19, NA, NA, NA, NA, NA),
  #   linetype = c(0, 0, 0, 1, 1 ,1)
  # ))) +
  ggtitle("Phy vs. Del_phy") +
  labs(color = "Legend Title")

# Chl vs. Del_phy
ag_df_CR %>% 
  ggplot(aes(x=chl, y=del_phy, color = "Points")) + 
  geom_point() +
  geom_hline(aes(yintercept = mean(ag_df_CR$del_phy), color = "Del_phy Mean Trendline"), linetype = "dashed") +
  geom_hline(aes(yintercept = median(ag_df_CR$del_phy), color = "Del_phy Median Trendline"), linetype = "dashed") +
  geom_smooth(aes(color = "Best Fit Line"), method = "lm", se = FALSE) +
  geom_vline(aes(xintercept = mean(ag_df_CR$chl), color = "Chl Mean Trendline"), linetype = "dashed") +
  geom_vline(aes(xintercept = median(ag_df_CR$chl), color = "Chl Median Trendline"), linetype = "dashed") +
  scale_color_manual(values = c("Points" = "red", 
                                 "Del_phy Mean Trendline" = "blue", "Del_phy Mean Trendline" = "green", 
                                 "Best Fit Line" = "purple", 
                                 "Chl Mean Trendline" = "orange", "Chl Median Trendline" = "brown"), 
                     breaks = c("Points", "Del_phy Mean Trendline", "Del_phy Median Trendline", 
                                "Best Fit Line", "Chl Mean Trendline", "Chl Median Trendline"),
                     labels = c("Points", "Del_phy Mean Trendline", "Del_phy Median Trendline", 
                                "Best Fit Line", "Chl Mean Trendline", "Chl Median Trendline")) +
  # guides(color = guide_legend(override.aes = list(
  #   shape = c(19, NA, NA, NA, NA, NA),
  #   linetype = c(0, 0, 0, 1, 1 ,1)
  # ))) +
  ggtitle("Chl vs. Del_phy") +
  labs(color = "Legend Title")





#median: do 0.5 quantile regression




```



#   TABLED (TBD)



#HISTOGRAM

ccm uses y to predict x, if true, x can affect y ccm wraps (Simplex
target = x, columns = y)

multivariate Simplex ( Embedded = True, columns = c("x1, "x2)) set CCM
samples to 10 to see result


#PULL GRAPHS

```{r}
plots.dir.path <- list.files(tempdir("C:\\Users\\mfman\\AppData\\Local\\Temp\\RtmpaE80Ug"), pattern="rs-graphics", full.names = TRUE); 
plots.png.paths <- list.files(plots.dir.path, pattern=".png", full.names = TRUE)
```

```{r}
file.copy(from=plots.png.paths, to="C:/Users/mfman/OneDrive/Desktop/HAB_PLOTS")

```


